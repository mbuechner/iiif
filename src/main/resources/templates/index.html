<!doctype html>
<html lang="de">
    <head>
        <meta charset="utf-8">
        <meta content="width=device-width, initial-scale=1" name="viewport">
        <title>Deutsche Digitale Bibliothek | IIIF Presentation API 3.0-Manifeste</title>
        <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" rel="stylesheet">
        <style>
            body {
                background: #EC0A3C;
                background: linear-gradient(276.83deg, #EC0A3C, #A5003B);
                min-height: 100vh;
            }
            .form-control::placeholder {
                color: #ccc;
            
            }
            .image-parent {
                max-height: 80px;
            }</style>
    </head>
    <body>
        <div class="container">
            <div class="row my-5">
                <div class="col-lg-12 mx-auto text-white text-center">
                    <h1 class="display-4">IIIF Presentation API 3.0</h1>
                    <p class="lead mb-0">Mit diesem Dienst können DDB-Objekte zu IIIF Presentation API 3.0-Manifeste umgewandelt werden.</p>
                    <p class="lead mb-0"> Außerdem können die IIIF-Manifeste in den verschiedenen Viewer betrachtet werden.</p>
                    <p class="lead">Implementierung auf <a class="text-white" href="https://github.com/mbuechner/iiif" target="_blank"><u>GitHub</u></a>. </p>
                </div>
            </div>
            <div class="row mb-3">
                <div class="p-1 bg-light rounded shadow-sm mb-4">
                    <div class="input-group">
                        <button aria-expanded="false" class="btn btn-light dropdown-toggle rounded-start col col-12 col-xl-3 mx-auto" data-bs-toggle="dropdown" id="displayType" type="button">IIIF Presentation API 3.0 Manifest</button>
                        <ul class="dropdown-menu dropdown-menu-start col col-12 col-xl-3 mx-auto" id="displayTypeDropdown">
                            <li>
                                <a class="dropdown-item" data-href="">IIIF Presentation API 3.0 Manifest</a>
                            </li>
                            <li>
                                <a class="dropdown-item" data-href="https://projectmirador.org/embed/?iiif-content=">Mirador 3</a>
                            </li>
                            <li>
                                <a class="dropdown-item" data-href="https://uv-v4.netlify.app/#?manifest=">Universal Viewer 4</a>
                            </li>
                            <li>
                                <a class="dropdown-item" data-href="https://samvera-labs.github.io/clover-iiif/?iiif-content=">Clover</a>
                            </li>
                            <li>
                                <a class="dropdown-item" data-href="https://ncsu-libraries.github.io/annona/tools/#/display?viewtype=iiif-rangestoryboard&amp;settings=%7B%22fullpage%22%3Atrue%7D&amp;url=">Annona</a>
                            </li>
                            <li>
                                <a class="dropdown-item" data-href="https://presentation-validator.iiif.io/validate?version=3.0&amp;url=">Presentation API Validator</a>
                            </li>
                        </ul>
                        <input aria-label="Text input with dropdown button" class="form-control col col-12 col-xl-8 mx-auto" id="input" placeholder="https://www.deutsche-digitale-bibliothek.de/item/CRHMM44XWLG7ZNH55BQ5GSAHTYLXJ7Z4" type="text">
                        <a class="btn bg-light rounded-end disabled col col-12 col-xl-1 mx-auto" data-href="" href="#" id="los" role="button" target="_blank">Los!</a>
                    </div>
                </div>
            </div>
            <div class="row mb-3">
                <div class="col-12 col-xxl-10 mx-auto">
                    <div class="list-group">
                        <div id="mylistgroupitems"></div>
                    </div>
                </div>
            </div>
        </div>
        <script crossorigin="anonymous" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
        <script crossorigin="anonymous" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
        <script crossorigin="anonymous" integrity="sha512-HYiNpwSxYuji84SQbCU5m9kHEsRqwWypXgJMBtbRSumlx1iBB6QaxgEBZHSHEGM+fKyCX/3Kb5V5jeVXm0OglQ==" src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/4.1.0/mustache.min.js"></script>
        <script>
            const items = {
                items:[ {
                    title: "Inv. 01451 + P.Michael. 52, Köln, Papyrussammlung", link: "NIHZBW7QZS352TCBKRUQPXPO2LGFSFJN", text: "Zwei hochaufgelöste Fotos aus der Papyrussammlung.", uuid: "a318e30e-3934-4c6b-94b9-2e2daf8cc3e4"
                }, {
                    title: "Flöte", link: "UT7QCBPP626TE3HTJDMJN7HVJ22IUEEO", text: "Sechs hochaufgelöste Fotos einer Flöte.", uuid: "c6f53bd0-2f2a-4f24-a9b3-f7f812135c65"
                }, {
                    title: "Träume / von Richard Wagner", status: "warning", link: "7PQO65ASPKENCHEOMMQLLE3INGF5NRYV", text: "Zwei Audiodateien mit Schallplattencover. Die Cover werden in der DDB nicht extra angezeigt und als Platzhalterbild für die Audio-Dateien benutzt. IIIF sieht vor, dass die Dauer der Audiodateien im Manifest angegeben werden. Diese Information liegt in der DDB nicht vor, entsprechend kann z.B. der universalviewer die Daten nicht korrekt anzeigen.", uuid: "5e8456a1-cf17-4d78-8a17-02bca068ab94"
                }, {
                    title: "Julius Neubronner zaubert", status: "warning", link: "UODH7ABRU3KEFW4W3LTX2EYKOD6UKANO", text: "Ein Video. Das Video hat zusätzlich ein Still, das in den IIIF-Manifesten und im Gegensatz zum DDB-Portal angezeigt wird. Der Universal Viewer benötigt zwingen die Spieldauer eines Videos. Diese Information kann von der DDB nicht zur Verfügung gestellt werden, entsprechend funktioniert die Anzeige von Video/ Audio im Universal-Viewer nicht korrekt.", uuid: "937976e0-5072-4f18-9fb0-4c19cf99041d"
                }, {
                    title: "Drehbuch (2. Fassung, Auszug), mit handschriftlichen Korrekturen von Artur Brauner.", status: "warning", link: "D6EKHXZC454ZLGAURLN6T5O7WBEEQRI3", text: "Eine PDF-Datei mit Vorschaubild. PDFs werden aktuell nur vom Universal Viewer unterstützt. Der Mirador 3 Viewer zeigt z.B. nur eine weiße Seite an.", uuid: "2695e3da-a40a-4a09-b8b1-2f5b23e0f93b"
                }, {
                    title: "Eingabe von Berichten und Gesuchen durch den Galerieinspektor Stassen und den Galeriedirektor Zoll sowie Erlasse des Oberhofmarschallamts und der Großherzoglich Badischen Intendanz sämtlicher Kunst-Cabinette", link: "IRMHSA4Q6RXQVYADHYNIQNVE53T6JREJ", text: "Eine 106-seitige Archivalie. Das Laden dauert länger, weil für jedes Digitalisat die maximale Auflösung über den IIIF Image-Dienst herausgefunden werden muss.", uuid: "8ce3ca07-1fcb-4d53-8a40-661eb94f4693"
                }, {
                    title: "Rad (2001)", status: "danger", link: "F3WJONMF6NXB3IJQLRYV5LR67KDPMQTA", text: "Vimeo-Videos können in IIIF nicht repräsentiert werden. Entsprechend zeigt keiner der Viewer diese an.", uuid: "70f8f639-6689-41a4-9542-83a866d155ca"
                }, {
                    title: "Auriga (1967), Frachtschiff, Argo Reederei Richard Adler & Söhne, Bremen, Bau-Nr. 1140", link: "TTNVQWVXY3AKILUHHULXB5H2ZHZGEKOO", text: "Ein hochaufgelöstes Digitalisat aus der Peter Tamm Sen. Stiftung.", uuid: "410f4523-0424-4d38-a692-3f68fda5a5d5"
                }, {
                    title: "Der Schimmelreiter oder Unsere Welt vom Ende her denken", status: "warning", link: "QCWBCVL6F64T6PHGAUCIFC57CWUC7YXV", text: "Eine Bild-, eine Video- und sechs Audio-Dateien.", uuid: "b8f008da-77c0-4361-939e-dcb59e53e5f5"
                }, {
                    title: "Von den verschiedenen Racen der Menschen : zur Ankündigung der Vorlesungen der physischen Geographie im Sommerhalbenjahre 1775", link: "D7CTTZ55NCSYJMZFBOAEE5PSS2PVODZT", text: "Monographie", uuid: "27022be4-f9cc-4b44-a0e5-c7b3303202b1"
                }, {
                    title: "Berliner Volksblatt", link: "IGBWWKK6ACCZAM5SMI34F6GEQO5RNXUG", text: "Zeitung", uuid: "5ba11d48-99f8-46dd-9945-6b5c8cbadff7"
                }, {
                    title: "Ein Trinkspruch des Bruders Eberhard auf das Vaterland bei der Tafelloge. am 20.1.1921.", link: "C4OICKVZCLE3E2HVAQGEVKK6MOGJOLKV", text: "Abschnitt", uuid: "ee36852f-f0d2-4737-ab6c-66ac71cca6f7"
                }, {
                    title: "Kaiserlicher Und Königlicher, Wie auch Erz-Herzoglicher, Und Dero Residenz-Stadt, Wien, Staats- und Stands-Calender / Auf das Jahr M. DCCXXXV", link: "M3FDWSLR53SH7A25HS34Z5AVEYMYLSZV", text: "Heft", uuid: "00f77a76-976d-4d60-98d7-934621fd601f"
                }, {
                    title: "Abtheilung 2: Fortgeseztes Altes und Neues Berlin : Darinnen die Historie der Kirchen zu Marien, Petri, im grauen Kloster, der Garnison, auf dem Fridrichswerder, Dorotheen- und Fridrichsstadt, wie auch der Hospitäler, Waysenhäuser und Gymnasiorum in Berlin von ihrem...", link: "FNY2WQQOGN4ZV6DJIADNKWFWXH2F73HT", text: "Band", uuid: "474df81d-5078-469a-bd3c-728520b06bac"
                }]
            };
            
            const template = ' \
            {{#items}} \
            <a class="list-group-item {{#status}}list-group-item-{{status}} {{/status}}d-flex justify-content-between align-items-center" href="https://www.deutsche-digitale-bibliothek.de/item/{{link}}"> \
            <div> \
            <div class="fw-bold">{{title}}</div> \
            <div class="row small"><div class="col-12 mb-1 text-break">https://www.deutsche-digitale-bibliothek.de/item/{{link}}</div><div class="col-12 text-muted">{{text}}</div></div> \
            </div> \
            <img alt="quixote" class="img-fluid image-parent" src="https://iiif.deutsche-digitale-bibliothek.de/image/2/{{uuid}}/full/!116,87/0/default.jpg"> \
            </a> \
            {{/items}}';
            
            $(document).ready(function () {
                function valueChanged() {
                    const url = window.location.href.endsWith("/") ? window.location.href: window.location.href + "/";
                    const string = $("#input").val();
                    const regexp = new RegExp("https:\/\/www\.deutsche-digitale-bibliothek\.de\/item\/([ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789]{32})", "g");
                    const match = regexp.exec(string);
                    if (match !== null && match[1] !== null) {
                        if ($("#los").attr("data-href").length === 0) {
                            $("#los").attr("href", url + match[1]);
                        } else {
                            $("#los").attr("href", $("#los").attr("data-href") + encodeURIComponent(url + match[1]));
                        }
                        $("#los").removeClass("disabled");
                    } else {
                        $("#los").attr("href", "#");
                        $("#los").addClass("disabled");
                    }
                }
                // see https://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array
                function shuffle(array) {
                    let currentIndex = array[ 'items'].length, randomIndex;
                    // While there remain elements to shuffle.
                    while (currentIndex != 0) {
                        // Pick a remaining element.
                        randomIndex = Math.floor(Math.random() * currentIndex);
                        currentIndex--;
                        // And swap it with the current element.
                        [array[ 'items'][currentIndex], array[ 'items'][randomIndex]] =[
                        array[ 'items'][randomIndex], array[ 'items'][currentIndex]];
                    }
                    return array;
                }
                
                $("#mylistgroupitems").html(Mustache.render(template, shuffle(items)));
                
                $(".dropdown-menu li a").click(function () {
                    $(".btn:first-child").text($(this).text());
                    $(".btn:first-child").val($(this).text());
                    $("#los").attr("data-href", $(this).attr("data-href"));
                    valueChanged();
                });
                
                $('#input').on('input', function () {
                    valueChanged();
                });
                
                $('#input').on('keydown', function (e) {
                    if (e.which === 13 && ! $("#los").hasClass("disabled")) {
                        window.open($("#los").attr("href"), '_blank');
                    }
                });
                
                $('.list-group-item').click(function (e) {
                    e.preventDefault();
                    $('#input').val($(this).attr("href"));
                    valueChanged();
                    window.scrollTo({
                        top: 0, behavior: 'smooth'
                    });
                });
            });</script>
    </body>
</html>
